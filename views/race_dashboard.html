<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/stylesheets/race.css">
    <link rel='stylesheet' href='/stylesheets/navbar.css' />
    <title>Race Data</title>
</head>
<body id="race-dashboard">

<div class="timer-container dashboard-content">
    <div>
        <h2>Race Information</h2>
        <div id="race-info"></div>
<!--        <p><strong>Name:</strong> John Doe</p>-->
<!--        <p><strong>Loop (km):</strong> 12</p>-->
<!--        <p><strong>Created At:</strong> 2025-04-03 20:01:20</p>-->
<!--        <p><strong>Start Time:</strong> 11/02/2025, 22:29</p>-->
<!--        <p><strong>Cutoff Time:</strong> 02:30</p>-->
    </div>
</div>
<script>
    const raceInfo = document.getElementById('race-info');

    function newParagraph(title, subTitle){
        let paragraph = document.createElement('p');
        let strong = document.createElement('strong');
        strong.textContent = `${title}: `;
        //<p><strong>Loop (km):</strong> 12</p>
        paragraph.appendChild(strong);
        paragraph.appendChild(document.createTextNode(subTitle));
        raceInfo.appendChild(paragraph);
    }

    function populateCurrentRace(){
        fetch('/api/current-race', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            },
        }).then((res) => res.json())
            .then((data) => {
                if(data.error){
                    showToast("An error occur", "error");
                }else{
                    newParagraph('Name', data.name);
                    newParagraph('Loop (km)', `${data.loop_km} km`);
                    newParagraph('Start Time', data.start_time);
                    newParagraph('Cutoff Time', data.cutoff_time);
                }
            }).catch((err) => {
            console.log('User not logged in', 'error');
        });
    }

    // document.addEventListener('DOMContentLoaded', () => {
    //     console.log('raceInfo -> ' + raceInfo);
    //     console.log('DOM fully loaded and parsed');
    //
    // });
    populateCurrentRace();

</script>
</body>
</html>
